{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{loginUser,registerUser,resetPassword,checkEmailExists}from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export const useAuth=()=>{const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(true);useEffect(()=>{// Check for stored user data on app load\nconst storedUser=localStorage.getItem('currentUser');if(storedUser){const userData=JSON.parse(storedUser);setUser(userData);setIsAuthenticated(true);}setLoading(false);},[]);const login=async(email,password)=>{try{const userData=await loginUser(email,password);setUser(userData);setIsAuthenticated(true);localStorage.setItem('currentUser',JSON.stringify(userData));}catch(error){throw error;}};const register=async(email,password,name)=>{try{const userData=await registerUser(email,password,name);setUser(userData);setIsAuthenticated(true);localStorage.setItem('currentUser',JSON.stringify(userData));}catch(error){throw error;}};const logout=()=>{setUser(null);setIsAuthenticated(false);localStorage.removeItem('currentUser');};const saveArticle=article=>{if(user){const updatedUser={...user,savedArticles:[...user.savedArticles,article]};setUser(updatedUser);localStorage.setItem('currentUser',JSON.stringify(updatedUser));}};const unsaveArticle=articleUrl=>{if(user){const updatedUser={...user,savedArticles:user.savedArticles.filter(article=>article.url!==articleUrl)};setUser(updatedUser);localStorage.setItem('currentUser',JSON.stringify(updatedUser));}};const forgotPassword=async email=>{try{const emailExists=await checkEmailExists(email);if(!emailExists){throw new Error('Email not found in our system');}// In a real app, this would send an email\nreturn true;}catch(error){throw error;}};const resetUserPassword=async(email,newPassword)=>{try{await resetPassword(email,newPassword);}catch(error){throw error;}};const value={user,login,register,logout,saveArticle,unsaveArticle,isAuthenticated,forgotPassword,resetUserPassword,loading};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","loginUser","registerUser","resetPassword","checkEmailExists","jsx","_jsx","AuthContext","undefined","useAuth","context","Error","AuthProvider","_ref","children","user","setUser","isAuthenticated","setIsAuthenticated","loading","setLoading","storedUser","localStorage","getItem","userData","JSON","parse","login","email","password","setItem","stringify","error","register","name","logout","removeItem","saveArticle","article","updatedUser","savedArticles","unsaveArticle","articleUrl","filter","url","forgotPassword","emailExists","resetUserPassword","newPassword","value","Provider"],"sources":["D:/Curser Projects/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { AuthContextType, User, Article } from '../types';\r\nimport { \r\n  loginUser, \r\n  registerUser, \r\n  resetPassword, \r\n  checkEmailExists,\r\n  getUserById \r\n} from '../services/authService';\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Check for stored user data on app load\r\n    const storedUser = localStorage.getItem('currentUser');\r\n    if (storedUser) {\r\n      const userData = JSON.parse(storedUser);\r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  const login = async (email: string, password: string) => {\r\n    try {\r\n      const userData = await loginUser(email, password);\r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n      localStorage.setItem('currentUser', JSON.stringify(userData));\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const register = async (email: string, password: string, name: string) => {\r\n    try {\r\n      const userData = await registerUser(email, password, name);\r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n      localStorage.setItem('currentUser', JSON.stringify(userData));\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n    localStorage.removeItem('currentUser');\r\n  };\r\n\r\n  const saveArticle = (article: Article) => {\r\n    if (user) {\r\n      const updatedUser = {\r\n        ...user,\r\n        savedArticles: [...user.savedArticles, article],\r\n      };\r\n      setUser(updatedUser);\r\n      localStorage.setItem('currentUser', JSON.stringify(updatedUser));\r\n    }\r\n  };\r\n\r\n  const unsaveArticle = (articleUrl: string) => {\r\n    if (user) {\r\n      const updatedUser = {\r\n        ...user,\r\n        savedArticles: user.savedArticles.filter(\r\n          (article) => article.url !== articleUrl\r\n        ),\r\n      };\r\n      setUser(updatedUser);\r\n      localStorage.setItem('currentUser', JSON.stringify(updatedUser));\r\n    }\r\n  };\r\n\r\n  const forgotPassword = async (email: string) => {\r\n    try {\r\n      const emailExists = await checkEmailExists(email);\r\n      if (!emailExists) {\r\n        throw new Error('Email not found in our system');\r\n      }\r\n      // In a real app, this would send an email\r\n      return true;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const resetUserPassword = async (email: string, newPassword: string) => {\r\n    try {\r\n      await resetPassword(email, newPassword);\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const value: AuthContextType = {\r\n    user,\r\n    login,\r\n    register,\r\n    logout,\r\n    saveArticle,\r\n    unsaveArticle,\r\n    isAuthenticated,\r\n    forgotPassword,\r\n    resetUserPassword,\r\n    loading\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}